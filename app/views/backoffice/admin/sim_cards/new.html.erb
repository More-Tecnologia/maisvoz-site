<!-- Page-Title -->
<div class="row">
  <div class="col-sm-12 m-b-23">
    <h4 class="page-title"><%= t('.title') %></h4>
  </div>
</div>

<div class="row">
  <div class="col-sm-12">
    <div class="card-box" style="padding-bottom: 0px;">
      <div class="row">
        <table class="table table-striped" style="word-break: break-word;">
          <tbody>
            <tr>
              <td><strong> <%= User.human_attribute_name(:user) %>: </strong></td>
              <td> <%= link_to "#{@order_item.order.user.name} (#{@order_item.order.user.username})", '' %> </td>
            </tr>
            <tr>
              <td> <strong> <%= OrderItem.human_attribute_name(:order_id) %> </strong> </td>
              <td> <strong> <%= link_to(@order_item.try(:order).try(:hashid), backoffice_admin_order_path(@order_item.order)) if @order_item.try(:order) %> </strong> </td>
            </tr>
            <tr>
              <td> <strong> <%= OrderItem.human_attribute_name(:product) %> </strong> </td>
              <td> <strong> <%= @order_item.try(:product).try(:name) %> </strong> </td>
            </tr>
            <tr>
              <td> <strong> <%= OrderItem.human_attribute_name(:quantity) %> </strong> </td>
              <td> <strong> <%= @order_item.try(:quantity) %> </strong> </td>
            </tr>
            <tr>
              <td> <strong> <%= OrderItem.human_attribute_name(:quantity_per_product) %> </strong> </td>
              <td> <strong> <%= @order_item.try(:product).try(:quantity).try(:to_i) %> </strong> </td>
            </tr>
            <tr class='text-success'>
              <td> <strong> <%= OrderItem.human_attribute_name(:sim_card_quantity) %> </strong> </td>
              <td> <strong id="iccids-count"> <%= @order_item.total_quantity.to_i %> </strong> </td>
            </tr>
            <tr class="<%= @sim_cards.size >= @order_item.total_quantity.to_i ? 'text-danger' : 'text-warning' %>">
              <td> <strong> <%= t('defaults.sim_cards_added') %></strong> </td>
              <td> <strong id='iccid-count'> <%= @sim_cards.size  %> </strong> </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-sm-12">
    <%= form_tag(backoffice_admin_order_item_sim_cards_path(@order_item)) do %>
      <div class="form-row align-items-center">
        <div class="col-sm-6">
          <%= text_field_tag :sim_card_iccid, '', class: 'form-control',
                                                  placeholder: SimCard.human_attribute_name(:iccid).to_s.downcase,
                                                  id: 'iccid' %>
        </div>
        <div class="col-auto my-1">
          <%= submit_tag t('helpers.submit.submit', model: ''), class: 'btn btn-primary' %>
        </div>
      </div>
      <div class="form-row">
        <ul id="iccids-hidden">
        </ul>
      </div>
    <% end %>
  </div>
</div>

<div class="row">
  <div class="col-sm-12" style="margin-top: 10px;">
    <ul id="iccids">
    </ul>
  </div>
</div>

<%= render 'backoffice/admin/sim_cards/index' %>
