<!-- Page-Title -->
<div class="row">
    <div class="col-sm-12">
        <h4 class="page-title"><%= t('.title') %></h4>
        <ol class="breadcrumb">
          <li><a href="#"><%= t('app_name') %></a></li>
          <li><%= link_to t('views.backoffice.orders.index.title'), backoffice_orders_path %></li>
          <li class="active"><%= t('.title') %></li>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="panel panel-default">
            <div class="panel-body" id="page-print">
                <div class="clearfix">
                    <div class="pull-right">
                        <h4><%= t('.invoice') %> # <br>
                            <strong><%= @order.hashid %></strong>
                        </h4>
                    </div>
                </div>
                <hr>
                <div class="row">
                    <div class="col-md-12">

                        <div class="pull-left m-t-30">
                            <address>
                              <strong><%= @order.user.name %></strong><br>
                              <strong><%= @order.user.username %></strong><br>
                              <%= @order.user.address %><br>
                              <%= @order.user.address_2 %>, <%= @order.user.city %>, <%= @order.user.state %> <%= @order.user.country %><br>
                              <abbr title="Phone">P:</abbr> <%= @order.user.phone %>
                              </address>
                        </div>
                        <div class="pull-right m-t-30">
                            <p><strong><%= t('.order_date') %>: </strong> <%= l @order.created_at, format: :short %></p>
                            <p class="m-t-10"><strong><%= t('.status') %>: </strong> <span class="label label-default"><%= t "defaults.#{@order.status}" %></span></p>
                            <p class="m-t-10"><strong><%= Order.human_attribute_name(:id) %>: </strong> #<%= @order.hashid %></p>
                        </div>
                    </div>
                </div>
                <div class="m-h-50"></div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="table-responsive">
                            <table class="table m-t-30">
                                <thead>
                                    <tr><th>#</th>
                                    <th><%= OrderItem.human_attribute_name(:item) %></th>
                                    <th><%= OrderItem.human_attribute_name(:quantity) %></th>
                                    <th><%= OrderItem.human_attribute_name(:cellphone_number) %></th>
                                    <th><%= OrderItem.human_attribute_name(:unit_cost) %></th>
                                    <th><%= OrderItem.human_attribute_name(:total) %></th>
                                </tr></thead>
                                <tbody>
                                  <% @order.order_items.each do |oi| %>
                                  <tr>
                                    <td><%= oi.product.id %></td>
                                    <td><%= link_to oi.product.name, backoffice_product_path(oi.product) %></td>
                                    <td><%= oi.quantity %></td>
                                    <th><%= number_to_phone(oi.cellphone_number, pattern: /(\d{2})(\d{5})(\d{4})$/) if oi.cellphone_number.present? %></th>
                                    <td><%= number_to_currency oi.unit_price %></td>
                                    <td><%= number_to_currency oi.total %></td>
                                  </tr>
                                  <% end %>

                                  <% @order.monthly_order_items.each do |oi| %>
                                  <tr>
                                    <td><%= oi.product.id %></td>
                                    <td><%= oi.product.name %></td>
                                    <td><%= oi.quantity %></td>
                                    <td><%= number_to_currency oi.unit_price %></td>
                                    <td><%= number_to_currency oi.total %></td>
                                  </tr>
                                  <% end %>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row" style="border-radius: 0px;">
                    <div class="col-md-6">
                      <p>&nbsp;</p>
                      <p>Para agilizar o pagamento realize uma transferência (TED) para a conta baixo: <br><br>
                        Bradesco: 237 <br>
                        Agência: 0343 <br>
                        Conta Corrente: 28106-9 <br>
                        MAISVOZ TELECOMUNICAÇÕES EIRELI <br>
                        CNPJ: 31.852.400/0001-59 <br>
                        Nos envie o comprovante de transferência no e-mail <a href="mailto:financeiro@maisvoz.com.br">financeiro@maisvoz.com.br</a>, <br>
                        para que possamos concluir o pagamento do seu pedido em nosso sistema. <br>
                        <br>
                        Cordialmente, <br>
                        Equipe Mais Voz.</p>
                    </div>
                    <div class="col-md-3 col-md-offset-3">
                        <p class="text-right"><b><%= t('.subtotal') %>:</b> <%= @order.subtotal %></p>
                        <p class="text-right"><%= Order.human_attribute_name(:shipping) %>: <%= @order.shipping %></p>
                        <p class="text-right"><%= t('.taxes') %>: <%= @order.tax %></p>
                        <hr>
                        <h3 class="text-right"><%= number_to_currency @order.total %></h3>
                    </div>
                    <div class="pull-right">
                      <% if !@order.completed? && !@order.expired? %>
                        <%= link_to '<i class="fas fa-barcode m-r-5"></i> Imprimir Boleto'.html_safe, @order.current_transaction.boleto_url, class: 'btn btn-primary btn-xs',  target: '_blank' if @order.current_transaction %>
                        <%= button_to(backoffice_order_generate_boleto_path(@order), class: 'btn btn-primary btn-xs', method: :post, data: { disable_with: 'Gerando...' }) do %>
                          <i class="fas fa-file m-r-5"></i> Gerar Boleto
                        <% end if @order.current_transaction.blank? %>
                      <% end %>
                    </div>
                </div>
                <hr>
                <div class="hidden-print">
                    <div class="pull-right">
                        <a href="javascript:$('#page-print').printThis()" class="btn btn-inverse waves-effect waves-light"><i class="fa fa-print"></i></a>
                    </div>
                </div>
            </div>
        </div>

    </div>

</div>
